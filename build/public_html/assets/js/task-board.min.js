function loadTasks(e){$.ajax({url:"../resources/src/scripts/fetchColumns.php",type:"POST",dataType:"html",data:{projectId:e,requestType:"all"},success:function(e){$("#listsContentAjax").html(e),$('ul[id^="sort"]').sortable({appendTo:".lists",helper:"clone",connectWith:".sortable",start:function(e,t){$(t.placeholder).hide(200)},change:function(e,t){$(t.placeholder).hide().show(200)},receive:function(e,t){var a=$(t.item).parent(".sortable").attr("data-columnid"),o=$(t.item).attr("data-taskid");$.ajax({url:"../resources/src/scripts/updateTaskColumn.php",type:"POST",dataType:"JSON",data:{taskId:o,columnId:a},success:function(e){$('[data-columnid="'+e.c_OldId+'"] > header > h6.taskCountAjax').text(e.c_OldCount),$('[data-columnid="'+e.c_NewId+'"] > header > h6.taskCountAjax').text(e.c_NewCount);var t=$('[data-columnid="'+e.c_OldId+'"]').attr("data-limit"),a=$('[data-columnid="'+e.c_NewId+'"]').attr("data-limit");e.c_OldCount<=t&&0!=t?$('.list[data-columnid="'+e.c_OldId+'"]').removeClass("overLoad"):e.c_NewCount>a&&0!=a&&$('.list[data-columnid="'+e.c_NewId+'"]').addClass("overLoad")}})}}).disableSelection(),$(".listName").each(function(){var e=$(this).text();if(18<e.length){var t=e.substr(0,15)+"...";$(this).text(t)}})},error:function(){window.location.replace("project-board")}})}function loadProjectInfo(e){$.ajax({url:"../resources/src/scripts/fetchProjects.php",type:"POST",dataType:"JSON",data:{id:e,requestType:"single"},success:function(e){$(".projectNameAjax").text(e.projectName),$("#projectStatusAjax").text(e.projectStatus),$("#projectClientAjax").text(e.projectClient),$("#projectDescriptionAjax").text(e.projectDescription),$("#projectStatus").text(e.projectStatus),$("#projectCategoryAjax").text(e.projectCategory),$("#projectCreatedAjax").text(e.projectCreatedFormated),$("#projectStartAjax").text(e.projectStartFormated),$("#projectEndAjax").text(e.projectEndFormated),"overDue"===e.overdueClass?$("#overdueProjectAjax").addClass("overDue"):"noOverdue"===e.overdueClass&&$("#overdueProjectAjax").removeClass("overDue"),$("input#attachDir").val(e.projectDirectory),$("input#dirZIP").val(e.projectDirectory),$("input#projectZIP").val(e.projectName),$("input#i_pN").val(e.projectName),$(".shortTitle").each(function(){var e=$(this).text();if(22<e.length){var t=e.substr(0,19)+"...";$(this).text(t)}})},error:function(){window.location.replace("project-board")}})}function loadMyProfile(){$.ajax({url:"../resources/src/scripts/fetchProfile.php",type:"POST",dataType:"JSON",data:{requestType:"my"},success:function(e){$("input#userName").val(e.userName),$("textarea#userAbout").val(e.userAbout),$(".userEmail").text(e.userEmail),$(".uNameAjax").text(e.userName),$("img.uAvatarAjax").attr("src","uploads/users/"+e.userAvatar),$("#profileModal").on("shown.bs.modal",function(){var e=document.querySelector("#userAbout");autosize.update(e)})},error:function(){}})}function showAllMembers(e){$.ajax({url:"../resources/src/scripts/fetchUsers.php",type:"POST",dataType:"html",data:{requestType:"all",projectId:e},success:function(e){$("#membersContent").html(e)},error:function(){}})}function showNotAssignedMembers(e){$.ajax({url:"../resources/src/scripts/fetchUsers.php",type:"POST",dataType:"html",data:{requestType:"notassigned",projectId:e},success:function(e){$("#membersContent").html(e)},error:function(){}})}function showInvitedMembers(e){$.ajax({url:"../resources/src/scripts/fetchUsers.php",type:"POST",dataType:"html",data:{requestType:"invited",projectId:e},success:function(e){$("#membersContent").html(e)},error:function(){}})}function loadTimers(e){$.ajax({url:"../resources/src/scripts/fetchTimers.php",type:"POST",dataType:"text",data:{requestType:"all",projectId:e},success:function(e){$("#timerListContent").html(e),$('[data-toggle="tooltip"]').tooltip()}})}function loadAttachData(e){$.ajax({url:"../resources/src/scripts/fetchAttachments.php",type:"POST",dataType:"text",data:{taskId:e,requestType:"all"},success:function(e){$("#attachmentListContent").html(e)},error:function(){alert("error")}})}$(document).ajaxSend(function(e,t,a){$("#ajax_loader").show()}),$(document).ajaxComplete(function(e,t,a){$("#ajax_loader").hide()}),$(document).ready(function(){$(function(){$('[data-toggle="tooltip"]').tooltip()}),autosize(document.querySelectorAll("textarea")),$("#taskPriority").slider(),$("#taskPriority").on("change",function(e){$("#currentPriority").text(e.value.newValue)})}),$(document).ready(function(){var o=$("#projectInfo").attr("data-id");loadTasks(o);var e=$("#_column");e.validate({rules:{columnName:{required:!0,minlength:2,maxlength:100},color:{required:!0},columnLimit:{min:1,digits:!0,number:!0}},messages:{columnName:{required:"Prosím, zadajte názov stĺpca",minlength:"Minimálna dĺžka je 2 znaky",maxlength:"Maximálna dĺžka je 100 znakov"},color:{required:"Vyberte farbu"},columnLimit:{min:"Limit musí byť aspoň 1",digits:"Prosím, zadajte celé číslo",number:"Prosím, zadajte celé číslo"}},submitHandler:function(){if(e.valid())return $.ajax({url:"../resources/src/scripts/insertColumn.php",type:"POST",dataType:"JSON",data:e.serialize(),success:function(e){return 200===e.code&&$("#addColumnModal").modal("hide"),loadTasks(o),!1},error:function(){}}),!1}}),$(document).on("click",".updateColumn",function(){var e=$(this).attr("data-id");$.ajax({url:"../resources/src/scripts/fetchColumns.php",type:"POST",dataType:"JSON",data:{id:e,requestType:"single",projectId:o},success:function(e){$("#addColumnModalTitle").text("Úprava stĺpca"),$("input#c_Id").val(e.id),$("#createColumnButton").text("Upraviť"),$("#columnName").val(e.columnName),$("#_column").find(':radio[name=color][value="'+e.color+'"]').prop("checked",!0),0!=e.columnLimit&&$("#columnLimit").val(e.columnLimit),$("#addColumnModal").modal("show")},error:function(){}})}),$("#addColumnModal").on("hidden.bs.modal",function(){$("#_column")[0].reset(),$("#_column").validate().resetForm(),$("em.invalid-feedback").remove(),$(".form-control").removeClass("is-invalid"),$("input#c_Id").val(""),$("#addColumnModalTitle").text("Pridanie stĺpca"),$("#createColumnButton").text("Pridať")}),$(document).on("click",".moveColumnTasks",function(){var a=$(this).attr("data-id");$.ajax({url:"../resources/src/scripts/fetchColumns.php",type:"POST",dataType:"html",data:{requestType:"allForm",projectId:o},success:function(e){$("#defaultModalTitle").text("Presun úloh"),$("#defaultModalContentAjax").html(e),$("input#columnId").val(a),$("#defaultModal").modal("show");var t=$("#_columnMove");t.validate({rules:{newColumnId:{required:!0}},messages:{newColumnId:{required:"Prosím, vyberte stĺpec."}},submitHandler:function(){if(t.valid())return $.ajax({url:"../resources/src/scripts/moveTasks.php",type:"POST",dataType:"JSON",data:t.serialize()+"&requestType=move",success:function(e){200===e.code?(loadTasks(o),$("#defaultModal").modal("hide"),alert(e.msg)):404===e.code&&alert(e.msg)},error:function(){}}),!1}})},error:function(){}})}),$(document).on("click",".deleteColumn",function(){var t=$(this).attr("data-id"),e=$(this).closest(".listHeader").find("h6.taskCountAjax").text();$.ajax({url:"../resources/src/scripts/deleteColumn.php",type:"POST",dataType:"html",data:{requestType:"show",countTasks:e,columnId:t},success:function(e){$("#defaultModalTitle").text("Vymazanie stĺpca"),$("#defaultModalContentAjax").html(e),$("#defaultModal").modal("show"),$(document).off("click","#deleteColumnButton").on("click","#deleteColumnButton",function(e){$.ajax({url:"../resources/src/scripts/deleteColumn.php",type:"POST",dataType:"JSON",data:{requestType:"delete",columnId:t,projectId:o},success:function(e){200===e.code?(loadTasks(o),$("#defaultModal").modal("hide")):404===e.code&&(alert(e.msg),$("#defaultModal").modal("hide"))},error:function(){}}),e.preventDefault()})},error:function(){}})})}),$(document).ready(function(){var e=0,t=0,a=0,o=0,r=0,s=0,n=$("#clockTimer");if($("#stopTimer").data("start")){var d=$("#stopTimer").attr("data-start"),i=Math.round(Date.now()/1e3)-d;o=i%60,r=Math.floor(i/60)%60,s=Math.floor(i/60/60),setInterval(function(){60<=++o&&(o=0,60<=++r&&(r=0,s++)),e=o<10?"0"+o.toString():o,t=r<10?"0"+r.toString():r,a=s<10?"0"+s.toString():s,n.html(a+" : "+t+" : "+e)},1e3)}}),$(document).ready(function(){var t=$("#projectInfo").attr("data-id");loadProjectInfo(t),$("#projectInfoModal").on("shown.bs.modal",function(e){$.ajax({url:"../resources/src/scripts/fetchTasks.php",type:"POST",dataType:"JSON",data:{requestType:"graph",id:t},success:function(e){var t=$("#statChart"),a=e.done,o=e.open;new Chart(t,{type:"doughnut",data:{datasets:[{data:[a,o],backgroundColor:["#3ea7db","#babcbe"]}],labels:["Dokončené úlohy","Nedokončené úlohy"]},options:{legend:{labels:{fontColor:"black",defaultFontFamily:"'Roboto'"}},emptyOverlay:{message:"Zatiaľ neboli vytvorené žiadne úlohy",fillStyle:"rgba(255,255,255,1.0)",fontStrokeWidth:0}}})},error:function(){}}),$.ajax({url:"../resources/src/scripts/fetchTasks.php",type:"POST",dataType:"JSON",data:{requestType:"cycleTime",id:t},success:function(e){"404"!=e.code?1==e.averageCycleTime?$("#cycleTimeAjax").text(e.averageCycleTime+" deň"):1<e.averageCycleTime<5?$("#cycleTimeAjax").text(e.averageCycleTime+" dni"):$("#cycleTimeAjax").text(e.averageCycleTime+" dní"):$("#cycleTimeAjax").html('<span style="font-size: 12px;"";">'+e.msg+"</span>")},error:function(){}}),$.ajax({url:"../resources/src/scripts/fetchUsers.php",type:"POST",dataType:"JSON",data:{requestType:"statistics",projectId:t},success:function(e){$("#assignedUsersAjax").text(e.assigned),$("#assignedProgressbarAjax").css("width",e.assigned+"%"),$("#acceptedUsersAjax").text(e.accepted),$("#acceptedProgressbarAjax").css("width",e.accepted+"%")},error:function(){}})})}),$(document).ready(function(){loadMyProfile();var e=$("#_profile");e.validate({rules:{userName:{required:!0,minlength:2,maxlength:50},userAbout:{minlength:10,maxlength:400}},messages:{userName:{required:"Prosím, zadajte meno.",minlength:"Meno musí obsahovať minimálne 2 znaky."},userAbout:{minlength:"Popis musí obsahovať minimálne 10 znakov.",maxlength:"Popis musí obsahovať maximálne 400 znakov."}},submitHandler:function(){if(e.valid())return $.ajax({url:"../resources/src/scripts/updateProfile.php",type:"POST",dataType:"JSON",data:e.serialize(),success:function(e){return loadMyProfile(),alert(e.msg),!1},error:function(){}}),!1}}),$("#_avatarForm").on("submit",function(e){e.preventDefault(),$.ajax({url:"../resources/src/scripts/uploadAvatar.php",method:"POST",data:new FormData(this),dataType:"json",contentType:!1,cache:!1,processData:!1,success:function(e){return"200"==e.code?(loadMyProfile(),$("#changeAvatarModal").modal("hide")):alert(e.msg),!1},error:function(){alert("error")}})}),$("#changeAvatarModal").on("hidden.bs.modal",function(){$("#profileModal").modal("show")}),$("#changeAvatarModal").on("show.bs.modal",function(){$("#profileModal").modal("hide")})}),$(document).ready(function(){function i(e){$.ajax({url:"../resources/src/scripts/fetchComments.php",type:"POST",dataType:"text",data:{taskId:e,requestType:"all"},success:function(e){$("#commentContentAjax").html(e),$('[data-toggle="tooltip"]').tooltip()},error:function(){alert("error")}})}function o(e){$.ajax({url:"../resources/src/scripts/fetchUsers.php",type:"POST",dataType:"html",data:{taskId:e,requestType:"task"},success:function(e){$("#taskMemberContentAjax").html(e),$('[data-toggle="tooltip"]').tooltip()},error:function(){alert("error")}})}$("#taskModal").on("show.bs.modal",function(e){var d=$(e.relatedTarget).attr("data-taskid");null==d&&(d=$("#showAttachButton").attr("data-id")),o(d),$.ajax({url:"../resources/src/scripts/fetchTasks.php",type:"POST",dataType:"JSON",data:{id:d,requestType:"single"},success:function(e){0==e.taskStatus&&0==e.taskStarted?($("#taskCompletedAjax").text(""),$("#startButton").removeClass("d-none").addClass("d-block"),$("#completeButton").removeClass("d-block").addClass("d-none"),$("#completeTitle").removeClass("d-block").addClass("d-none")):0==e.taskStatus&&0!=e.taskStarted?($("#taskCompletedAjax").text(""),$("#completeButton").removeClass("d-none").addClass("d-block"),$("#startButton").removeClass("d-block").addClass("d-none"),$("#completeTitle").removeClass("d-block").addClass("d-none")):1==e.taskStatus&&($("#taskCompletedAjax").text(e.taskCompletedFormatted),$("#completeButton").removeClass("d-block").addClass("d-none"),$("#completeTitle").removeClass("d-none").addClass("d-block")),$("#updateTask").attr("data-id",d),$("#deleteTask").attr("data-id",d),$("#completeButton").attr("data-id",d),$("#startButton").attr("data-id",d),$("#showAttachButton").attr("data-id",d),$("input#taskId").val(d),$("input#cTaskId").val(d),$("#taskNameAjax").text(e.taskName),$("#taskDescriptionAjax").text(e.taskDescription),$("#taskPriorityAjax").text(e.taskPriority),$("#taskDueDateAjax").text(e.taskDueDateFormatted),$("#taskCreatedAjax").text(e.taskCreatedFormatted),"overDue"==e.overdueClass&&$("#overdueTaskAjax").addClass("overDue")},complete:function(){$("#taskModal").modal("show")},error:function(){alert("error")}}),$(document).on("click","#assignMemberTaskButton",function(){var e=$("#projectInfo").attr("data-id");$.ajax({url:"../resources/src/scripts/fetchUsers.php",type:"POST",dataType:"html",data:{requestType:"noAssignedTask",projectId:e,taskId:d},success:function(e){$("#defaultModalTitle").text("Priradenie člena"),$("#defaultModalContentAjax").html(e),$("#members").selectpicker();var t=$("#_taskMember");t.find("input#taskId").val(d),$("#defaultModal").modal("show"),t.validate({rules:{"members[]":{required:!0}},messages:{"members[]":"Prosím, vyberte aspoň jedného člena."},submitHandler:function(){if(t.valid())return $.ajax({url:"../resources/src/scripts/assignMembers.php",type:"POST",dataType:"JSON",data:t.serialize()+"&requestType=task",success:function(e){200===e.code?($("#defaultModal").modal("hide"),o(d)):404===e.code&&alert(e.msg)},error:function(){}}),!1}})},error:function(){}})}),$(document).on("click",".unassignUserTaskAjax",function(){var t=$(this).attr("data-id"),a=$("#projectInfo").attr("data-id");$.ajax({url:"../resources/src/scripts/unassignUser.php",type:"POST",dataType:"html",data:{requestType:"showTask"},success:function(e){$("#defaultModalTitle").text("Odobratie užívateľa z úlohy"),$("#defaultModalContentAjax").html(e),$("#defaultModal").modal("show"),$(document).off("click","#unassignTaskMemberButton").on("click","#unassignTaskMemberButton",function(e){$.ajax({url:"../resources/src/scripts/unassignUser.php",type:"POST",dataType:"JSON",data:{requestType:"unassignTask",memberId:t,taskId:d,projectId:a},success:function(e){200===e.code?(o(d),$("#defaultModal").modal("hide")):404===e.code&&alert(e.msg)},error:function(){}}),e.preventDefault()})},error:function(){}})});var t=$("#_commentForm");i(d),$(document).on("click",".editComment",function(){var o,r=$(this).attr("data-id"),s=$(this).addClass("d-none"),n=$('<textarea class="form-control" id="'+r+'" rows="1"></textarea>');$.ajax({url:"../resources/src/scripts/fetchComments.php",type:"POST",dataType:"JSON",data:{commentId:r,requestType:"single"},success:function(e){n.text(e.commentContent),o=e.commentContent,$("div#"+r).html(n),n.focus().height($(n)[0].scrollHeight),autosize($("textarea"))},error:function(){alert("error")}}),n.keyup(function(e){var t=this.value;if(autosize($("textarea")),t.length<5||800<t.length)return $("#editComentAjax-error").remove(),n.parent(".putError").after('<em id="editComentAjax-error" class="invalid-feedback d-block">Komentár musí obsahovať minimálne 5 a maximálne 800 znakov.</em>'),n.addClass("is-invalid").removeClass("is-valid"),!1;$("#editComentAjax-error").remove(),n.removeClass("is-invalid").addClass("is-valid")}),$(n).on("focusout",function(e){var t=n.val(),a=$('<p style="white-space: pre-line; padding: .375rem .75rem;" class="m-0" id="'+r+'"></p>');return""===n.val()||t===o?($("#editComentAjax-error").remove(),$("div#"+r).html(o),s.removeClass("d-none")):5<=t.length&&t.length<=800&&($("#editComentAjax-error").remove(),n.removeClass("is-invalid"),$.ajax({type:"POST",dataType:"JSON",url:"../resources/src/scripts/updateComment.php",data:{idComment:r,cContent:t},success:function(e){if(200==e.code)return a.text(t),$("div#"+r).html(a),s.removeClass("d-none"),!1;404==e.code&&(alert(e.msg),$("#editComentAjax-error").remove(),$("div#"+r).html(o),s.removeClass("d-none"),i(d))},error:function(){alert("error")}})),!1})}),t.validate({rules:{cContent:{required:!0,minlength:5,maxlength:800}},messages:{cContent:{required:"Prosím, zadajte komentár.",minlength:"Komentár musí obsahovať minimálne 5 znakov.",maxlength:"Komentár musí obsahovať maximálne 800 znakov."}},submitHandler:function(){if(t.valid())return $.ajax({url:"../resources/src/scripts/createComment.php",type:"POST",dataType:"JSON",data:t.serialize(),success:function(e){},error:function(){},complete:function(){$("textarea#cContent").val("");var e=document.querySelector("#cContent");autosize.update(e),i(d=$("#showAttachButton").attr("data-id"))}}),!1}}),$("#deleteCommentModal").on("show.bs.modal",function(e){var t=$(e.relatedTarget).attr("data-id");$("input#idComment").val(t),$(document).off("click","#deleteCommentButton").on("click","#deleteCommentButton",function(e){e.preventDefault(),$.ajax({url:"../resources/src/scripts/deleteComment.php",method:"POST",dataType:"JSON",data:$("#_deleteComment").serialize(),success:function(e){200==e.code?($("#deleteCommentModal").modal("hide"),i(d)):e.code},error:function(){}})})})})}),$(document).ready(function(){var t=$("#projectInfo").attr("data-id");$("#showMembersModal").on("show.bs.modal",function(e){showAllMembers(t)}),$("#m_allButton").on("click",function(e){showAllMembers(t)}),$("#m_notAssignedButton").on("click",function(e){showNotAssignedMembers(t)}),$("#m_invitedButton").on("click",function(e){showInvitedMembers(t)}),$(document).on("click",".unassignUserProjectAjax",function(){var t=$(this).attr("data-id"),a=$("#projectInfo").attr("data-id");$.ajax({url:"../resources/src/scripts/unassignUser.php",type:"POST",dataType:"html",data:{requestType:"showProject"},success:function(e){$("#defaultModalTitle").text("Odobratie užívateľa z projektu"),$("#defaultModalContentAjax").html(e),$("#defaultModal").modal("show"),$(document).off("click","#unassignProjectMemberButton").on("click","#unassignProjectMemberButton",function(e){$.ajax({url:"../resources/src/scripts/unassignUser.php",type:"POST",dataType:"JSON",data:{requestType:"unassignProject",memberId:t,projectId:a},success:function(e){200===e.code?(showAllMembers(a),$("#defaultModal").modal("hide")):404===e.code&&alert(e.msg)},error:function(){}}),e.preventDefault()})},error:function(){}})})}),$(document).ready(function(){var r=$("#projectInfo").attr("data-id"),n="člen";$("#memberInfoModal").on("show.bs.modal",function(e){var t,a,o=$(e.relatedTarget).attr("data-id");$.ajax({url:"../resources/src/scripts/fetchUsers.php",type:"POST",dataType:"json",data:{requestType:"single",projectId:r,userId:o},success:function(e){$("#memberNameAjax").html(e.userName),n=e.userName,$("#memberAvatarAjax").attr("src","uploads/users/"+e.userAvatar),$("#memberEmailAjax").html(e.userEmail),$("#memberAboutAjax").html(e.userAbout),$("#memberRegisteredAjax").html(e.userCreated),$("#memberAssignedAjax").html(e.userAssigned),$.ajax({url:"../resources/src/scripts/fetchTasks.php",type:"POST",dataType:"JSON",data:{requestType:"memberGraph",projectId:r,userId:o},success:function(e){var t=$("#memberChart"),a=e.done,o=e.open,r=(new Chart(t,{type:"pie",data:{datasets:[{data:[a,o],backgroundColor:["#3ea7db","#babcbe"]}],labels:["Dokončené úlohy - "+n,"Nedokončené úlohy - "+n]},options:{legend:{labels:{fontColor:"black",defaultFontFamily:"'Roboto'"},position:"top"},emptyOverlay:{message:n+" zatiaľ nemá priradené žiadne úlohy",fillStyle:"rgba(255,255,255,1.0)",fontStrokeWidth:0}}}),$("#doneChart")),s=e.doneAll;new Chart(r,{type:"pie",data:{datasets:[{data:[a,s],backgroundColor:["#3ea7db","#babcbe"]}],labels:["Dokončené úlohy - "+n,"Všetky dokončené úlohy v projekte"]},options:{legend:{labels:{fontColor:"black",defaultFontFamily:"'Roboto'"},position:"top"},emptyOverlay:{message:"Zatiaľ neboli dokončené žiadne úlohy.",fillStyle:"rgba(255,255,255,1.0)",fontStrokeWidth:0}}})},error:function(){}}),$.ajax({url:"../resources/src/scripts/fetchTimers.php",type:"POST",dataType:"JSON",data:{requestType:"workTimeGraph",projectId:r,userId:o},success:function(e){var t=$("#timeChart"),a={datasets:[{data:[e.timeUser,e.timeAll],backgroundColor:["#3ea7db","#babcbe"]}],labels:["Pracovný čas - "+n+" [ "+e.timeUserFormatted+" ]","Pracovný čas - všetci [ "+e.timeAllFormatted+" ]"]};new Chart(t,{type:"pie",data:a,options:{legend:{labels:{fontColor:"black",defaultFontFamily:"'Roboto'"},position:"top"},emptyOverlay:{message:"Zatiaľ neboli vytvorené žiadne časovače.",fillStyle:"rgba(255,255,255,1.0)",fontStrokeWidth:0}}})},error:function(){}})},error:function(){}}),t=r,a=o,$.ajax({url:"../resources/src/scripts/fetchTimers.php",type:"POST",dataType:"html",data:{requestType:"my",projectId:t,userId:a},success:function(e){$("#memberTimesheetContent").html(e)}})})}),$(document).ready(function(){var t=$("#projectInfo").attr("data-id"),e=($("#startTimer"),$("#stopTimer"),$("#stopTimerFormButton"),$("#t_Form"));$(document).on("click","#startTimer",function(){$.ajax({url:"../resources/src/scripts/insertTimer.php",method:"POST",dataType:"json",data:{requestType:"start",projectId:t},success:function(e){switch(e.code){case 200:window.location=window.location;break;case 404:alert(e.msg);break;default:$("#taskActionsAjax").html("Chyba časovača"),console.log("error")}},error:function(){}})}),$(document).on("click","#timeSheetButton",function(e){loadTimers(t),$("#timersModal").modal("show")}),$(".buttonLogout").on("click",function(){$.ajax({url:"../resources/src/scripts/insertTimer.php",type:"POST",dataType:"JSON",data:{requestType:"check"},success:function(e){switch(e.code){case 200:window.location="../resources/src/scripts/logoutUser.php";break;case 404:$("#backToProject").attr("data-projectid",e.projectId),$("#timerCheckModal").modal("show");break;default:window.location="../resources/src/scripts/logoutUser.php"}},error:function(){alert(error)}})}),$("#backToProject").on("click",function(){var e=$(this).attr("data-projectid");window.location="task-board?project="+e}),e.validate({rules:{timerNote:{minlength:5,maxlength:400}},messages:{timerNote:{minlength:"Popis musí obsahovať minimálne 5 znakov.",maxlength:"Popis musí obsahovať maximálne 400 znakov."}},submitHandler:function(){if(e.valid())return $.ajax({url:"../resources/src/scripts/insertTimer.php",type:"POST",dataType:"JSON",data:e.serialize()+"&requestType=stop",success:function(e){window.location=window.location},error:function(){alert(error)}}),!1}})}),$(document).ready(function(){var e=$("#i_Form");e.validate({rules:{memberEmail:{required:!0,email:!0},iMessage:{minlength:5,maxlength:400}},messages:{memberEmail:{required:"Prosím, zadajte váš email",email:"Zadajte správny tvar emailu napr. meno@priezvisko.sk"},iMessage:{minlength:"Minimálna dĺžka správy musí byť 5 znakov",maxlength:"Maximálna dĺžka správy musí byť 400 znakov"}},submitHandler:function(){if(e.valid())return $(".memberSpinner").removeClass("d-none"),$.ajax({url:"../resources/src/scripts/sendInvitation.php",type:"POST",dataType:"JSON",data:e.serialize(),success:function(e){switch($(".memberSpinner").addClass("d-none"),e.code){case 200:$("#i_Form")[0].reset(),$("#i_Form").validate().resetForm(),$("em.invalid-feedback").remove(),$(".form-control").removeClass("is-invalid"),$("#addMembersModal").modal("hide");break;case 404:alert(e.msg);break;default:alert(e.msg),$("#i_Form")[0].reset(),$("#i_Form").validate().resetForm(),$("em.invalid-feedback").remove(),$(".form-control").removeClass("is-invalid"),$("#addMembersModal").modal("hide")}},error:function(){$(".memberSpinner").addClass("d-none")}}),!1}})}),$(document).ready(function(){$("#_zipAttach").validate({rules:{"attach[]":{required:!0,minlength:1}},messages:{"attach[]":"Prosím, vyberte aspoň jeden súbor."},errorPlacement:function(e,t){e.insertAfter("#errZIP")}})}),$(document).ready(function(){$("#showAttachButton").on("click",function(e){loadAttachData($(this).attr("data-id"))}),$("#deleteAttachModal").on("show.bs.modal",function(e){var t=$(e.relatedTarget),a=t.attr("data-id"),o=t.attr("data-name"),r=t.attr("data-dir"),s=t.attr("data-taskid");$(document).off("click","button#deleteAttachButton").on("click","button#deleteAttachButton",function(e){e.preventDefault(),$.ajax({url:"../resources/src/scripts/deleteAttachment.php",type:"POST",dataType:"JSON",data:{id:a,name:o,dir:r},success:function(e){loadAttachData(s),$("#deleteAttachModal").modal("hide")},error:function(){}})})})}),$(document).ready(function(){$("#_attachForm").on("submit",function(e){e.preventDefault(),$(".uploadSpinner").removeClass("d-none"),$.ajax({url:"../resources/src/scripts/uploadAttachment.php",method:"POST",data:new FormData(this),dataType:"json",contentType:!1,cache:!1,processData:!1,success:function(e){return"200"==e.code?($("#addAttachmentModal").modal("hide"),$(".uploadSpinner").addClass("d-none"),alert(e.msg)):(alert(e.msg),$(".uploadSpinner").addClass("d-none")),!1},error:function(){alert("error")}})})}),$(document).ready(function(){$("#taskModal").on("hidden.bs.modal",function(){$("#overdueTaskAjax").removeClass("overDue"),$("#_commentForm")[0].reset(),$("#_commentForm").validate().resetForm(),$("em.invalid-feedback").remove(),$(".form-control").removeClass("is-invalid"),$("#startButton").removeClass("d-block").addClass("d-none"),$("#completeButton").removeClass("d-block").addClass("d-none")}),$(document).on("click","#completeButton",function(){var t=$("#completeButton").attr("data-id");$.ajax({url:"../resources/src/scripts/completeTask.php",type:"POST",dataType:"JSON",data:{id:t},success:function(e){200==e.code?($('.taskButtonAjax[data-taskid="'+t+'"] > div.d-flex > div.statusDone').removeClass("d-none"),$("#completeButton").removeClass("d-block").addClass("d-none"),$("#completeTitle").removeClass("d-none").addClass("d-block"),$("#taskCompletedAjax").text(e.time),loadTasks($("#projectInfo").attr("data-id"))):404==e.code&&alert(e.msg)},error:function(){}})}),$(document).on("click","#startButton",function(){var e=$("#startButton").attr("data-id");$.ajax({url:"../resources/src/scripts/startTask.php",type:"POST",dataType:"JSON",data:{id:e},success:function(e){200==e.code?($("#completeButton").removeClass("d-none").addClass("d-block"),$("#startButton").removeClass("d-block").addClass("d-none"),loadTasks($("#projectInfo").attr("data-id"))):404==e.code&&alert(e.msg)},error:function(){}})})}),$(document).ready(function(){$("#addMembersModal").on("hidden.bs.modal",function(){$("#projectInfoModal").modal("show")}),$("#addMembersModal").on("show.bs.modal",function(){$("#projectInfoModal").modal("hide")}),$("#addAttachmentModal").on("hidden.bs.modal",function(){$("#taskModal").modal("show")}),$("#addAttachmentModal").on("show.bs.modal",function(){$("#taskModal").modal("hide")}),$("#showAttachmentModal").on("hidden.bs.modal",function(){$("#taskModal").modal("show")}),$("#showAttachmentModal").on("show.bs.modal",function(){$("#taskModal").modal("hide")}),$("#timersModal").on("hidden.bs.modal",function(){$("#projectInfoModal").modal("show")}),$("#timersModal").on("show.bs.modal",function(){$("#projectInfoModal").modal("hide")}),$("#memberInfoModal").on("hidden.bs.modal",function(){$("#showMembersModal").modal("show")}),$("#showMembersModal").on("show.bs.modal",function(){$("#projectInfoModal").modal("hide")}),$("#memberInfoModal").on("show.bs.modal",function(){$("#showMembersModal").modal("hide")})}),$(document).ready(function(){$("#newTaskModal").on("hidden.bs.modal",function(){$("#_task")[0].reset(),$("#id").val(""),$("#_task").validate().resetForm(),$("em.invalid-feedback").remove(),$(".form-control").removeClass("is-invalid"),$(".datepickerStart").flatpickr({altInput:!0,altFormat:"d. F Y",dateFormat:"Y-m-d",disableMobile:"true",defaultDate:"today"}),$("#taskPriority").slider("setValue",1),$("#currentPriority").text(1),$("#newTaskModalTitle").text("Nová úloha"),$("#createTaskButton").text("Vytvoriť")})}),$(document).ready(function(){var e=$("#_task");e.validate({rules:{taskName:{required:!0,minlength:2,maxlength:50},taskDescription:{required:!0,minlength:10,maxlength:400},taskPriority:{required:!0},taskDueDate:{required:!0}},messages:{taskName:{required:"Prosím, zadajte meno klienta.",minlength:"Názov musí obsahovať minimálne 2 znaky.",maxlenght:"Názov musí obsahovať minimálne 50 znakov."},taskDescription:{required:"Prosím, zadajte popis projektu.",minlength:"Popis musí obsahovať minimálne 10 znakov.",maxlength:"Popis musí obsahovať maximálne 400 znakov."},taskPriority:{required:"Prosím, zvoľte prioritu úlohy."},taskDueDate:{required:"Prosím, zvoľte plánované ukončenie úlohy."}},submitHandler:function(){e.valid()&&$.ajax({url:"../resources/src/scripts/insertTask.php",type:"POST",dataType:"JSON",data:e.serialize(),success:function(e){200==e.code&&$("#newTaskModal").modal("hide"),loadTasks($("#projectInfo").attr("data-id"))},error:function(){}})}}),$("#newTaskModal").on("hidden.bs.modal",function(){$("#_task")[0].reset(),$("#_task").validate().resetForm(),$("input#idTask").val(""),$("em.invalid-feedback").remove(),$(".form-control").removeClass("is-invalid"),$(".datepickerStart").flatpickr({altInput:!0,altFormat:"d. F Y",dateFormat:"Y-m-d",disableMobile:"true",defaultDate:"today"})}),$(document).on("click","#updateTask",function(){var e=$(this).attr("data-id");$.ajax({url:"../resources/src/scripts/fetchTasks.php",type:"POST",dataType:"JSON",data:{id:e,requestType:"single"},success:function(e){$("#newTaskModalTitle").text("Úprava úlohy"),$("#idTask").val(e.id),$("#createTaskButton").text("Upraviť"),$("#taskName").val(e.taskName),$("#taskDescription").val(e.taskDescription),$("#taskPriority").slider("setValue",e.taskPriority),$("#currentPriority").text(e.taskPriority),$("#taskDueDate").val(e.taskDueDate),$(".datepickerStart").flatpickr({altInput:!0,altFormat:"d. F Y",dateFormat:"Y-m-d",disableMobile:"true",defaultDate:e.taskDueDate}),$("#newTaskModal").modal("show"),$("#newTaskModal").on("shown.bs.modal",function(){var e=document.querySelector("#taskDescription");autosize.update(e)})},error:function(){}})}),$("#deleteTaskModal").on("show.bs.modal",function(e){var t=$(e.relatedTarget).attr("data-id"),a=$("#projectInfo").attr("data-id");$("input#idDelete").val(t),$(document).off("click","#deleteTaskButton").on("click","#deleteTaskButton",function(e){e.preventDefault(),$.ajax({url:"../resources/src/scripts/deleteTask.php",method:"POST",dataType:"JSON",data:$("#_deleteTask").serialize(),success:function(e){200==e.code?($("#deleteTaskModal").modal("hide"),$("#taskModal").modal("hide"),loadTasks(a)):404==e.code&&alert(e.msg)},error:function(){}})})})}),$(document).ready(function(){$("#openSideMenu").click(function(){$("#mobileSideMenuBg").css({visibility:"visible","background-color":"rgba(0,0,0,0.8"}),$("#mobileSideMenu").css({left:"0vw","box-shadow":"6px 3px 6px rgba(0,0,0,0.16)"})}),$("#closeSideMenu, #mobileSideMenuBg, #mobileTimersLink").click(function(){$("#mobileSideMenu").css({left:"-100vw","box-shadow":"none"}),$("#mobileSideMenuBg").css({visibility:"hidden","background-color":"rgba(0,0,0,0"})}),$("#hideMainSidebar").click(function(){$("#mainSidebar").toggleClass("hidden"),$("#expanded").toggleClass("d-none"),$("#expandedProjectName").toggleClass("d-none"),$("#expandIcon").toggleClass("d-none"),$("#compressIcon").toggleClass("d-none"),$("#mainContent").toggleClass("marged customWidth"),$("#listsContentAjax").toggleClass("expandedHeight"),$("#expandCreateTaskButton").toggleClass("d-none")}),$(".modal").on("shown.bs.modal",function(){$("#mobileSideMenu").css({left:"-100vw","box-shadow":"none"}),$("#mobileSideMenuBg").css({visibility:"hidden","background-color":"rgba(0,0,0,0"})})}),flatpickr.localize(flatpickr.l10ns.sk),$(document).ready(function(){$(".datepickerStart").flatpickr({altInput:!0,altFormat:"d. F Y",dateFormat:"Y-m-d",disableMobile:"true",defaultDate:new Date})}),$(document).ready(function(){bsCustomFileInput.init()});